define(["jquery","core/str"],(function(t,a){a.get_strings([{key:"addtocart",component:"local_products"},{key:"incart",component:"local_products"},{key:"adding...",component:"local_products"},{key:"removing...",component:"local_products"}]);return{init:function(){t(document).ready((function(){t(".addtocartbtn").click((function(){var a=t(this);if(t(this).hasClass("in-cart")){a.addClass("anim").text(M.util.get_string("removing...","local_products")),(r={action:"removefromcart"}).course=t(this).attr("id");var o=M.cfg.wwwroot+"/local/products/ajax/products_ajax.php";t.ajax({method:"POST",url:o,data:r,dataType:"json",async:!1}).done((function(o){if(o.status){a.removeClass("anim").removeClass("in-cart").addClass("add-to-cart-btn").html('<i class="fa fa-cart-plus" aria-hidden="true"></i> '+M.util.get_string("addtocart","local_products"));var r=t(".popover-region .nav-link .cart-count-badge").text();""!=r&&t(".popover-region .nav-link .cart-count-badge").text(parseInt(r)-1)}else a.removeClass("in-cart").html('<i class="fa fa-check" aria-hidden="true"></i> '+M.util.get_string("incart","local_products"))}))}else{var r;a.addClass("anim").text(M.util.get_string("adding...","local_products")),(r={action:"addtocart"}).course=t(this).attr("id");o=M.cfg.wwwroot+"/local/products/ajax/products_ajax.php";t.ajax({method:"POST",url:o,data:r,dataType:"json",async:!1}).done((function(o){if(o.status){a.removeClass("anim").addClass("in-cart").html('<i class="fa fa-check" aria-hidden="true"></i> '+M.util.get_string("incart","local_products"));var r=t(".popover-region .nav-link .cart-count-badge").text();""!=r&&t(".popover-region .nav-link .cart-count-badge").text(parseInt(r)+1)}else a.removeClass("in-cart").html('<i class="fa fa-cart-plus" aria-hidden="true"></i> '+M.util.get_string("addtocart","local_products"))}))}})),t(document).on("click",".card-link-secondary",(function(){var a=t(this).attr("data-id"),o=t(this).attr("data-courseid"),r={action:"removefromcart"};r.course=o;var c=M.cfg.wwwroot+"/local/products/ajax/products_ajax.php";t.ajax({method:"POST",url:c,data:r,dataType:"json",async:!1}).done((function(o){if(o.status){t("#single_cart_course_product_"+a).remove(),t("#separator_hr_"+a).remove();var r=t("#cart_item_count").text();""!=r&&(t("#cart_item_count").text(parseInt(r)-1),t(".popover-region .nav-link .cart-count-badge").text(parseInt(r)-1)),window.location.reload()}}))})),t("a").on("click",(function(a){if(""!==this.hash){a.preventDefault();var o=this.hash;t("html, body").animate({scrollTop:t(o).offset().top-100},800)}}))}))}}}));