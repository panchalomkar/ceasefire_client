var lang_locale="",lang=document.getElementsByTagName("html")[0].getAttribute("lang");""!=lang&&"en"!=lang&&"en-us"!=lang&&(lang_locale="local_people/"+lang),define(["jquery",lang_locale,"local_learningpaths/bootbox","local_people/bootstrap-datetimepicker"],function(s,e,a,t){function i(){var e=s(".filepicker-filename").find("a").html();void 0!==e&&""!==e&&""!=s("#id_description").val()&&"<p><br></p>"!=s("#id_description").val()&&""!==s("#id_name").val()?s("#id_submitbutton").attr("disabled",!1):s("#id_submitbutton").attr("disabled",!0)}return{init:function(){var t,n,r;s(document).ready(function(){s("#id_userperpage").change(function(){s(this).parents("form:first").submit()}),s("#courses-popup-content form").on("submit",function(e){if(e.preventDefault(),!s(".course-learninpath").is(":checked"))return a.alert({message:M.util.get_string("learningpath_required_course","local_learningpaths")}),!1;this.submit()}),s("#users-popup-content form").on("submit",function(e){if(e.preventDefault(),!s(".users-lpall").is(":checked"))return a.alert({message:M.util.get_string("learningpath_required_user","local_learningpaths")}),!1;this.submit()}),s("#cohorts-popup-content form").on("submit",function(e){if(e.preventDefault(),!s(".cohort-learninpath").is(":checked"))return a.alert({message:M.util.get_string("learningpath_required_cohorts","local_learningpaths")}),!1;this.submit()});var e={time:"fa fa-clock-o",date:"fa fa-calendar",up:"fa fa-chevron-up",down:"fa fa-chevron-down",previous:"fa fa-chevron-left",next:"fa fa-chevron-right",today:"fa fa-screenshot",clear:"fa fa-trash",close:"fa fa-remove"};s("#id_enddate").datetimepicker({icons:e,format:"MM/DD/YYYY",defaultDate:s("#lp_enddate").val()}),s("#id_startdate").datetimepicker({icons:e,format:"MM/DD/YYYY",defaultDate:s("#lp_startdate").val()}),s("#id_startdate").on("dp.change",function(e){s("#lp_startdate").val(s("#id_startdate").val())}),s("#id_enddate").on("dp.change",function(e){if(s("#lp_enddate").val(s("#id_enddate").val()),""===s("#id_startdate").val())return!1;s("#id_enddate").data("DateTimePicker").minDate(s("#id_startdate").val())})}),null!==document.querySelector("#page-local-learningpaths-index")&&(s("#id_submitbutton").attr("disabled",!0),s("input[name*='learningpath_imagechoose']").on("click",i),s('input[name="learningpath_image"], #id_description').on("change",i),s("#id_name").on("keyup",i),s("#id_submitbutton").on("click",function(){for(;null!==document.querySelector(".filepicker-container");){s("#id_submitbutton").attr("disabled",!0),a.alert(M.util.get_string("mandatory_msg","local_learningpaths"));break}for(;null==document.querySelector(".filepicker-container");)return s("#id_submitbutton").attr("disabled",!1),!0})),s(document).on("keyup",".add-users-search",(t=function(e){e.preventDefault();var a=s("#users-popup input[name=id]").val(),t=(s("#users-popup ul.pagination li > a").attr("href"),s(".add-users-search").val()),n=M.cfg.wwwroot+"/local/learningpaths/ajax.php";return s.ajax({type:"GET",url:n,data:{action:"pagination",id:a,search:t},dataType:"json",success:function(e){if(e.msg){s("#users-popup #users-popup-content").empty(),s("#users-popup-content").html(e.html),s(".add-users-search").focus();var a=s(".add-users-search").val();s(".add-users-search").val(""),s(".add-users-search").val(a)}}}),!1},n=1e3,r=0,function(){var e=this,a=arguments;clearTimeout(r),r=setTimeout(function(){t.apply(e,a)},n||0)})),s(document).on("click","#users-popup ul.pagination li > a",function(e){e.preventDefault();var a=s("#users-popup input[name=id]").val(),t=s(this).attr("href").replace("?","#");t=t.replace("&","#");var n=s(".add-users-search").val().toLowerCase(),r=t.split("#")[1].split("="),i=M.cfg.wwwroot+"/local/learningpaths/ajax.php";return s.ajax({type:"GET",url:i,data:{action:"pagination",page:r[1],id:a,search:n},dataType:"json",success:function(e){e.msg&&(s("#users-popup #users-popup-content").empty(),s("#users-popup-content").html(e.html))}}),!1}),s(document).on("change","#users-popup #id_userpopupperpage",function(e){var a=this.value,t=s("#users-popup input[name=id]").val(),n=s(".add-users-search").val().toLowerCase(),r=M.cfg.wwwroot+"/local/learningpaths/ajax.php";return s.ajax({type:"GET",url:r,data:{action:"pagination",id:t,perpage:a,search:n},dataType:"json",success:function(e){e.msg&&(s("#users-popup #users-popup-content").empty(),s("#users-popup-content").html(e.html))}}),!1}),s(".course-lp .form-check-input").click(function(){s(this).is(":checked")?s(this).parent().parent().parent().addClass("checkbbg"):s(this).parent().parent().parent().removeClass("checkbbg")}),s("#course-all").click(function(){s("#course-all").is(":checked")?s(".course-lp").addClass(" checkbbg"):s(".course-lp").removeClass(" checkbbg")}),s(".course-learninpath .form-check-input").click(function(){s(this).is(":checked")?s(this).parent().parent().parent().addClass("checkbbg"):s(this).parent().parent().parent().removeClass("checkbbg")})}}});