define(["jquery","theme_remui/select2"],function(c,e){return{init:function(){c(document).ready(function(){var e,a,t,o,i,n=(e=new RegExp("[\\?&]"+"id"+"=([^&#]*)"),a=window.location.href,null==(t=e.exec(a))?"":t[1]);("0"!==n||""!=n)&&0<n&&(o=c("#menucourse-selection"),i=o.val(),ajaxUrl=M.cfg.wwwroot+"/blocks/rlms_notifications/ajax/course_notification_form.php",data={id:i},c.ajax({method:"POST",url:ajaxUrl,data:data,dataType:"json"}).done(function(e){c("#edit_template_course_notifications form").css("display","block"),c(e).each(function(e,a){0!=a.enabled?c("#id_enabled_"+a.name).is(":checked")||c("#id_enabled_"+a.name).click():c("#id_enabled_"+a.name).is(":checked")&&c("#id_enabled_"+a.name).click(),c("#id_template_"+a.name).val(a.template),c("#id_template_"+a.name+"_ifr").contents().find("body").html(a.template)}),c("#edit_template_course_notifications").removeClass("hide")})),c(".mform fieldset.collapsible").each(function(e,a){var t=c(this).parent().parent().attr("id");c(this).addClass(""),"edit_template_course_notifications"!=t||(c(".ftoggler").addClass("notification_bg"),c(this).removeClass("clearfix"))}),c("#edit_template_course_notifications legend.ftoggler, #edit_template_course_notifications legend.ftoggler a").click(function(){var e=c(this).closest(".collapsible"),a=e.hasClass("collapsed");c("#edit_template_course_notifications legend.ftoggler").parent().addClass("collapsed"),1==a&&e.removeClass("collapsed")}),c("#menucourse-selection").change(function(){var e,a,t,o,i,n,l=c("#menucourse-selection").val();c("#cid").val(l),e="id",a=l,t=[location.protocol,"//",location.host,location.pathname].join(""),o=document.location.search,n="?"+(i=e+"="+a),o&&(keyRegex=new RegExp("([?&])"+e+"[^&]*"),n=null!==o.match(keyRegex)?o.replace(keyRegex,"$1"+i):o+"&"+i),window.history.replaceState({},"",t+n),window.location.href=location.href})})}}});