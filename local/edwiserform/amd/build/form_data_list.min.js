"use strict";define(["jquery","core/ajax","core/notification","core/templates","local_edwiserform/jquery.dataTables","local_edwiserform/dataTables.bootstrap4","local_edwiserform/buttons.bootstrap4","local_edwiserform/fixedColumns.bootstrap4","local_edwiserform/formviewer"],function(e,o,t,i){var n=function(){0!=e(".DTFC_LeftBodyLiner tr").length&&e(".DTFC_LeftBodyLiner tr").each(function(o,t){e(t).find(".efb-data-actions span").remove();var i=e(t).find(".efb-data-action.show");i.length<2||i.slice(0,i.length-1).after("<span> | </span>")})};return{update_separator:n,init:function(s,r){var a,l={DELETE_SUBMISSION:function(e){return o.call([{methodname:"edwiserform_delete_submissions",args:{id:s,submissions:e}}])[0]},GET_FORM_SUBMISSIONS:function(e,t,i){return o.call([{methodname:"edwiserform_get_form_submissions",args:{formid:s,search:e,start:t,length:i}}])[0]}};function c(o){Formeo.dom.multiActions("warning",M.util.get_string("deletesubmission","local_edwiserform"),M.util.get_string("deletesubmissionmsg","local_edwiserform"),[{title:M.util.get_string("proceed","local_edwiserform"),type:"danger",action:function(){Formeo.dom.loading(),l.DELETE_SUBMISSION(o).done(function(o){1==o.status&&(Formeo.dom.alert("success",'<div class="col-12">'+o.msg+"</div>"),a.draw(),e(".submission-check-all").prop("checked",!1)),Formeo.dom.loadingClose()}).fail(function(e){t.exception(e),Formeo.dom.loadingClose()})}},{title:M.util.get_string("cancel","local_edwiserform"),type:"success"}])}e.fn.dataTable.ext.errMode="none",e(document).ready(function(o){r||e("body").addClass("user-view"),a=e("#efb-form-submissions").DataTable({paging:!0,ordering:!1,bProcessing:!0,bServerSide:!0,rowId:"DT_RowId",bDeferRender:!0,scrollY:"400px",scrollX:!0,scrollCollapse:!0,classes:{sScrollHeadInner:"efb_dataTables_scrollHeadInner"},dom:'<"efb-top"<"efb-listing"l><"efb-list-filtering"f>>t<"efb-bottom"<"efb-list-pagination"p><B>'+(r?'<"efb-bulk">':"")+">i",language:{sSearch:M.util.get_string("efb-search-form","local_edwiserform"),emptyTable:M.util.get_string("listformdata-empty","local_edwiserform"),info:M.util.get_string("efb-heading-listforms-showing","local_edwiserform",{start:"_START_",end:"_END_",total:"_TOTAL_"}),infoEmpty:M.util.get_string("efb-heading-listforms-showing","local_edwiserform",{start:"0",end:"0",total:"0"})},buttons:[],ajax:function(o,i,s){l.GET_FORM_SUBMISSIONS(o.search.value,o.start,o.length).done(function(o){0!=o.errors.length&&function(o){for(var t=e("<ul></ul>"),i=0;i<o.length;i++)t.append(e("<li>"+o[i]+"</li>"));Formeo.dom.alert("warning",t.get(0))}(o.errors),delete o.errors,i(o),n()}).fail(t.exception)},drawCallback:function(o){n(),r&&(e(".efb-bottom .dt-buttons").removeClass("btn-group"),i.render("local_edwiserform/bulk-actions",{formid:s,wwwroot:M.cfg.wwwroot,license:"available"==license?"":M.util.get_string("activate-license","local_edwiserform")},"theme_remui").done(function(o,t){i.replaceNode(e(".efb-bulk"),o,t)}).fail(t.exception)),setTimeout(function(){var o=e(".DTFC_LeftHeadWrapper .efb-table tr th:first-child"),t=e(".DTFC_LeftBodyLiner .efb-table tr td:first-child");e(t).css("width",window.getComputedStyle(o[0]).width)},0)}}),new e.fn.dataTable.FixedColumns(a,{iLeftColumns:2})}),e("body").on("click",".efb-csv-export",function(){"available"==license?window.open(M.cfg.wwwroot+"/local/edwiserform/export.php?id="+s+"&action=data"):window.location.href=M.cfg.wwwroot+"/admin/settings.php?section=local_edwiserform&activetab=local_edwiserform_license_status"}),e("body").on("change",".submission-check-all",function(){e(".DTFC_Cloned .submission-check").prop("checked",e(this).is(":checked"))}),e("body").on("click","#efb-apply-actions",function(){switch(e("#efb-bulk-actions").val()){case"bulkaction":Formeo.dom.toaster(M.util.get_string("selectbulkaction","local_edwiserform"));break;case"delete":if(!e(".submission-check").is(":checked"))return void Formeo.dom.toaster(M.util.get_string("emptysubmission","local_edwiserform"));var o=[];e(".submission-check:checked").each(function(t,i){o.push(e(i).data("value"))}),c(o)}}),e("body").on("click",".efb-data-action.delete-action",function(){c([e(this).data("value")])}),e("body").on("click",".efb-data-action",function(e){e.preventDefault()})}}});
//# sourceMappingURL=form_data_list.min.js.map
