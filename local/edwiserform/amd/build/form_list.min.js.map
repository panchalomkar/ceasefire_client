{"version":3,"sources":["form_list.js"],"names":["define","$","Ajax","Notification","init","table","PROMISES","search","start","length","order","call","methodname","args","document","ready","e","DataTable","paging","ordering","bProcessing","bServerSide","rowId","bDeferRender","scrollY","scrollX","scrollCollapse","fixedColumns","leftColumns","rightColumns","classes","sScrollHeadInner","dom","columns","data","orderable","ajax","callback","settings","value","done","response","fail","exception","language","sSearch","M","util","get_string","emptyTable","info","end","total","infoEmpty","fnRowCallback","nRow","aData","iDisplayIndex","iDisplayIndexFull","addClass","attr","drawCallback","html","click","removeClass","on","event","preventDefault","id","this","row","parents","title","children","text","license","window","location","href","cfg","wwwroot","status","draw","input","formid","action","is","prop","parent","enable_disable_form","prev","temp","append","shortcode","val","select","execCommand","remove","Formeo","toaster"],"mappings":"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","sourcesContent":["/*\n * To change this license header, choose License Headers in Project Properties.\n * To change this template file, choose Tools | Templates\n * and open the template in the editor.\n */\n\n\ndefine([\n   'jquery',\n   'core/ajax',\n   'core/notification',\n   'local_edwiserform/jquery.dataTables',\n   'local_edwiserform/dataTables.bootstrap4',\n   'local_edwiserform/buttons.bootstrap4',\n   'local_edwiserform/fixedColumns.bootstrap4',\n   'local_edwiserform/formviewer'\n], function ($, Ajax, Notification) {\n    return {\n        init: function() {\n\n            var table;\n\n            var PROMISES = {\n\n                /**\n                 * Get forms using ajax\n                 * @param  {String}  search Search query\n                 * @param  {Number}  length Number of courses\n                 * @param  {Number}  start  Start index of courses\n                 * @param  {Array}   order  Column order\n                 * @return {Promise}        Ajax promise\n                 */\n                GET_FORMS: function(search, start, length, order) {\n                    return Ajax.call([{\n                        methodname: 'edwiserform_get_forms',\n                        args: {\n                            search : search,\n                            start  : start,\n                            length : length,\n                            order: order\n                        }\n                    }])[0];\n                },\n            };\n            $(document).ready(function (e) {\n                table = $(\"#efb-forms\").DataTable({\n                    paging          : true,\n                    ordering        : true,\n                    bProcessing     : true,\n                    bServerSide     : true,\n                    rowId           : 'DT_RowId',\n                    bDeferRender    : true,\n                    scrollY         : \"400px\",\n                    scrollX         : true,\n                    scrollCollapse  : true,\n                    fixedColumns    : {\n                        leftColumns     : 1,\n                        rightColumns    : 1\n                    },\n                    classes: {\n                        sScrollHeadInner: 'efb_dataTables_scrollHeadInner'\n                    },\n                    dom             : '<\"efb-top\"<\"efb-listing\"l><\"efb-list-filtering\"f>>t<\"efb-bottom\"<\"efb-form-list-info\"i><\"efb-list-pagination\"p>><\"efb-shortcode-copy-note\">',\n                    columns: [\n                        { data: \"title\" },\n                        { data: \"type\" },\n                        { data: \"shortcode\" , \"orderable\" : false},\n                        { data: \"author\" },\n                        { data: \"created\" },\n                        { data: \"author2\" },\n                        { data: \"modified\" },\n                        { data: \"allowsubmissionsfromdate\" },\n                        { data: \"allowsubmissionstodate\" },\n                        { data: \"actions\" , \"orderable\" : false}\n                    ],\n                    ajax: function(data, callback, settings) {\n                        PROMISES.GET_FORMS(\n                            data.search.value,\n                            data.start,\n                            data.length,\n                            data.order[0]\n                        ).done(function(response) {\n                            callback(response);\n                        }).fail(Notification.exception);\n                    },\n                    language        : {\n                        sSearch: M.util.get_string('efb-search-form', 'local_edwiserform'),\n                        emptyTable: M.util.get_string('listforms-empty', 'local_edwiserform'),\n                        info: M.util.get_string('efb-heading-listforms-showing', 'local_edwiserform', {'start': '_START_', 'end': '_END_', 'total': '_TOTAL_'}),\n                        infoEmpty: M.util.get_string('efb-heading-listforms-showing', 'local_edwiserform', {'start': '0', 'end': '0', 'total': '0'}),\n                    },\n                    \"fnRowCallback\" : function( nRow, aData, iDisplayIndex, iDisplayIndexFull ) {\n                        $('td:eq(0)', nRow).addClass( \"efb-tbl-col-title\");\n                        $('td:eq(2)', nRow).addClass( \"efb-tbl-col-shortcode\").attr('title', M.util.get_string('clickonshortcode', 'local_edwiserform'));\n                    },\n                    drawCallback    : function( settings ) {\n                        $('.efb-shortcode-copy-note').html(M.util.get_string('note', 'local_edwiserform') + ' ' + M.util.get_string('clickonshortcode', 'local_edwiserform'));\n                    }\n                });\n                $('.efb-modal-close').click(function() {\n                    $('#efb-modal').removeClass('show');\n                });\n                $('body').on('click', '.efb-form-delete', function(event) {\n                    event.preventDefault();\n                    var id = $(this).data('formid');\n                    var row = $(this).parents('tr');\n                    var title = $(row).children('.efb-tbl-col-title').text();\n                    $('#efb-modal .efb-modal-header').removeClass('bg-success').addClass('bg-warning').children('.efb-modal-title').html(M.util.get_string('warning', 'local_edwiserform'));\n                    $('#efb-modal .efb-modal-body').html('<h5>' + M.util.get_string('efb-delete-form-and-data', 'local_edwiserform', {\n                        title: title,\n                        id: id\n                    }) + '</h5>');\n                    $('#efb-modal').addClass('show delete').removeClass('pro');\n                    $('#efb-modal .efb-modal-delete-form').data('formid', id);\n                    return;\n                }).on('click', '.efb-form-export', function(event) {\n                    if (license != 'available') {\n                        $('#efb-modal .efb-modal-header').removeClass('bg-success').addClass('bg-warning');\n                        $('#efb-modal .efb-modal-title').html(M.util.get_string('hey-wait', 'local_edwiserform'));\n                        $('#efb-modal .efb-modal-body').html('<h5>' + M.util.get_string('efb-template-inactive-license', 'local_edwiserform', M.util.get_string('efb-form-action-export-title', 'local_edwiserform')) + '</h5>');\n                        $('#efb-modal').addClass('show pro').removeClass('delete');\n                        event.preventDefault();\n                        return;\n                    }\n                }).on('click', '.efb-modal-pro-activate', function() {\n                    window.location.href = M.cfg.wwwroot + '/admin/settings.php?section=local_edwiserform&activetab=local_edwiserform_license_status';\n                });\n                $('body').on('click', '.efb-modal-delete-form', function(event) {\n                    event.preventDefault();\n                    var id = $(this).data('formid');\n                    var reqDeleteForm = Ajax.call([{\n                        methodname: 'edwiserform_delete_form',\n                        args: {\n                            id: id\n                        }\n                    }]);\n                    reqDeleteForm[0].done(function(response) {\n                        if (response.status == true) {\n                            table.draw();\n                        }\n                    }).fail(Notification.exception);\n                    $('.efb-modal-close').click();\n                });\n\n                /**\n                 * Enable or disable form on the basis on form id\n                 * @param  {DOM} input DOM element\n                 */\n                function enable_disable_form(input) {\n                    var formid = $(input).data('formid');\n                    var enabledisableform = Ajax.call([{\n                        methodname: 'edwiserform_enable_disable_form',\n                        args: {\n                            id: formid,\n                            action: !$(input).is(':checked')\n                        }\n                    }]);\n                    enabledisableform[0].done(function(response) {\n                        if (response.status) {\n                            $(input).prop('checked', $(input).is(':checked'));\n                        } else {\n                            $(input).prop('checked', !$(input).is(':checked'));\n                        }\n                        $(input).parent().attr('title', $(input).is(':checked') ? $(input).data('disable-title') : $(input).data('enable-title'))\n                    }).fail(Notification.exception);\n                }\n\n                $('body').on('click', '.efb-enable-disable-form', function(event) {\n                    var input = $(this).prev();\n                    enable_disable_form(input);\n                });\n\n                $('body').on(\"click\", \".efb-tbl-col-shortcode\", function(event) {\n                    var temp = $('<input>');\n                    $('body').append(temp);\n                    var shortcode = $(this).text();\n                    temp.val(shortcode).select();\n                    document.execCommand('copy');\n                    temp.remove();\n                    Formeo.dom.toaster(M.util.get_string('shortcodecopied', 'local_edwiserform', shortcode));\n                });\n            });\n        }\n    };\n});\n"],"file":"form_list.min.js"}
