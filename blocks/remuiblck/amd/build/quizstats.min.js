define(["jquery","core/ajax","core/chartjs"],function(i,n){var t={ROOT:null,CHART:"#barChart",CHART_AREA:"#quiz-chart-area",COURSE_LIST:"#quiz-course-list",QUIZ_LIST:"#quiz-list",LIST_SELECTED:"option:selected",ERROR:".quiz-stats-error"},e=null,a=function(i){let n,t=0;return i.forEach(function(i,e){n=Math.max.apply(Math,i.data),t=n>t?n:t}),Math.ceil(t/20)};function o(){var o=d(),u=r();n.call([{methodname:"block_remuiblck_get_quiz_participation",args:{courseid:o,quizid:u}}])[0].done(function(n){if(void 0===n.datasets)i(t.ROOT).find(t.CHART_AREA).hide(),i(t.ROOT).find(t.ERROR).show();else{null!==e&&e.destroy();var o=i(t.ROOT).find(t.CHART).get(0).getContext("2d");o.canvas.height=400;var d={labels:n.labels,datasets:n.datasets};e=new Chart(o,{type:"bar",data:d,options:{responsive:!0,maintainAspectRatio:!1,scales:{yAxes:[{scaleLabel:{display:!0,labelString:M.util.get_string("noofstudents","block_remuiblck")},ticks:{min:0,stepSize:a(n.datasets)}}]}}})}}).fail(function(n){i(t.ROOT).find(t.CHART_AREA).hide(),i(t.ROOT).find(t.ERROR).show()})}var d=function(){return i(t.ROOT).find(t.COURSE_LIST+" "+t.LIST_SELECTED).data("courseid")},r=function(){return i(t.ROOT).find(t.QUIZ_LIST+" "+t.LIST_SELECTED).data("quizid")},u=function(){i(t.ROOT).find(t.COURSE_LIST).on("change",function(){var e;e=d(),n.call([{methodname:"block_remuiblck_get_quizzes_of_course",args:{courseid:e}}])[0].done(function(n){for(var e="",a=0;a<n.length;a++)e=(e=e+"<option data-id='"+n[a].courseid+"' data-quizid='"+n[a].quizid+"'>")+n[a].quizname+"</option>";i(t.ROOT).find(t.QUIZ_LIST).empty().append(e),o()}).fail(function(n){i(t.ROOT).find(t.CHART_AREA).hide(),i(t.ROOT).find(t.ERROR).show()})}),i(t.ROOT).find(t.QUIZ_LIST).on("change",function(){o()})};return{init:function(n){t.ROOT=n,i(document).ready(function(){u(),i(t.ROOT).find(t.CHART).length&&o()})}}});
//# sourceMappingURL=quizstats.min.js.map
