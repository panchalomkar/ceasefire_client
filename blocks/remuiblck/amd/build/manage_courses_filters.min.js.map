{"version":3,"sources":["manage_courses_filters.js"],"names":["define","$","CustomEvents","Notification","RemuiblckEvents","ManageCoursesView","SELECTORS","getManageCourseDisplay","root","find","data","getManageCoursesPerPage","init","manageCourseDisplayFilterContainer","events","activate","on","e","originalEvent","preventDefault","option","target","closest","hasClass","trigger","MANAGE_COURSES_DISPLAY_FILTER_CHANGE","M","util","set_user_preference","loadCourses","registerManageCourseDisplayFilter","manageCoursePerPageFilterContainer","MANAGE_COURSES_PAGE_FILTER_CHANGE","registerManageCoursePerPageFilter","pagenumber","maxpage","this","is","MANAGE_COURSES_PAGINATE","registerManageCoursePageFilter"],"mappings":"AAAAA,OAAO,CACH,SACA,iCACA,oBACA,yBACA,uCACD,SACCC,EACAC,EACAC,EACAC,EACAC,GAEA,IAAIC,EACc,sCADdA,EAEgB,gDAFhBA,EAGe,eAHfA,EAIiB,kCAJjBA,EAKU,yBALVA,EAMM,cANNA,EAOU,kBAgHVC,EAAyB,SAASC,GAClC,OAAOP,EAAEO,GAAMC,KAAKH,GAA0BG,KAAKH,EAA0B,WAAWI,KAAK,UAQ7FC,EAA0B,SAASH,GACnC,OAAOP,EAAEO,GAAMC,KAAKH,GAA2BG,KAAKH,EAA0B,WAAWI,KAAK,UAalG,MAAO,CACHE,KAPO,SAASJ,IAzHoB,SAASA,GAC7C,IAAIK,EAAqCZ,EAAEO,GAAMC,KAAKH,GACtDJ,EAAaF,OAAOa,EAAoC,CAACX,EAAaY,OAAOC,WAC7EF,EAAmCG,GAC/Bd,EAAaY,OAAOC,SACpBT,EACA,SAASW,EAAGP,GACRA,EAAKQ,cAAcC,iBAEnB,IAAIC,EAASnB,EAAEgB,EAAEI,QAAQC,QAAQhB,GAE7Bc,EAAOG,SAAS,YAKpBtB,EAAEgB,EAAEI,QAAQG,QAAQpB,EAAgBqB,sCACpCC,EAAEC,KAAKC,oBAAoB,mBAAoBR,EAAOV,KAAK,UAC3DL,EAAkBwB,YACdrB,EACAY,EAAOV,KAAK,SACZC,EAAwBH,GACxBP,EAAEO,GAAMC,KAAKH,GAAwBI,KAAK,mBAoGtDoB,CAAkCtB,GAzFE,SAASA,GAC7C,IAAIuB,EAAqC9B,EAAEO,GAAMC,KAAKH,GACtDJ,EAAaF,OAAO+B,EAAoC,CAAC7B,EAAaY,OAAOC,WAC7EgB,EAAmCf,GAC/Bd,EAAaY,OAAOC,SACpBT,EACA,SAASW,EAAGP,GACRA,EAAKQ,cAAcC,iBAEnB,IAAIC,EAASnB,EAAEgB,EAAEI,QAAQC,QAAQhB,GAE7Bc,EAAOG,SAAS,YAKpBtB,EAAEgB,EAAEI,QAAQG,QAAQpB,EAAgB4B,mCACpCN,EAAEC,KAAKC,oBAAoB,sBAAuBR,EAAOV,KAAK,UAC9DT,EAAEO,GAAMC,KAAKH,GAAwBI,KAAK,cAAe,GACzDL,EAAkBwB,YACdrB,EACAD,EAAuBC,GACvBY,EAAOV,KAAK,SACZ,MAmEZuB,CAAkCzB,GAxDD,SAASA,GACJP,EAAEO,GAAMC,KAAKH,GACnBU,GAC5B,QACA,SAASC,GACL,IAAIiB,EAAajC,EAAEO,GAAMC,KAAKH,GAAwBI,KAAK,eACvDyB,EAAUlC,EAAEO,GAAMC,KAAKH,GAAwBI,KAAK,cACxD,GAAIT,EAAEmC,MAAMC,GAAG/B,GAAiB,CAC5B,GAAI4B,GAAcC,EACd,OAEJD,QACG,CAAA,IAAGjC,EAAEmC,MAAMC,GAAG/B,GAMjB,OALA,GAAkB,GAAd4B,EACA,OAEJA,IAIJjC,EAAEO,GAAMC,KAAKH,GAAwBI,KAAK,cAAewB,GACzDjC,EAAEgB,EAAEI,QAAQG,QAAQpB,EAAgBkC,yBACpCjC,EAAkBwB,YACdrB,EACAD,EAAuBC,GACvBG,EAAwBH,GACxB0B,KA+BZK,CAA+B/B,GAC/BH,EAAkBwB,YAAYrB,EAAMD,EAAuBC,GAAOG,EAAwBH,KAI1FD,uBAAwBA","sourcesContent":["define([\n    'jquery',\n    'core/custom_interaction_events',\n    'core/notification',\n    'block_remuiblck/events',\n    'block_remuiblck/manage_courses_view'\n], function(\n    $,\n    CustomEvents,\n    Notification,\n    RemuiblckEvents,\n    ManageCoursesView\n) {\n    var SELECTORS = {\n        COURSES_LIST: '[data-region=\"manage-courses-list\"]',\n        DISPLAY_FILTER: '[data-region=\"manage-courses-display-filter\"]',\n        FILTER_OPTION: '[data-value]',\n        PER_PAGE_FILTER: '[data-region=\"per-page-filter\"]',\n        PAGINATE: '[data-action-paginate]',\n        NEXT: '[data-next]',\n        PREVIOUS: '[data-previous]',\n    };\n\n    /**\n     * Event listener for the display selector (\"Card\", \"List\", \"Summary\").\n     *\n     * @param {object} root The root element for the manage courses block\n     */\n    var registerManageCourseDisplayFilter = function(root) {\n        var manageCourseDisplayFilterContainer = $(root).find(SELECTORS.DISPLAY_FILTER);\n        CustomEvents.define(manageCourseDisplayFilterContainer, [CustomEvents.events.activate]);\n        manageCourseDisplayFilterContainer.on(\n            CustomEvents.events.activate,\n            SELECTORS.FILTER_OPTION,\n            function(e, data) {\n                data.originalEvent.preventDefault();\n\n                var option = $(e.target).closest(SELECTORS.FILTER_OPTION);\n\n                if (option.hasClass('active')) {\n                    // If it's already active then we don't need to do anything.\n                    return;\n                }\n\n                $(e.target).trigger(RemuiblckEvents.MANAGE_COURSES_DISPLAY_FILTER_CHANGE);\n                M.util.set_user_preference('managecourseview', option.data('value'));\n                ManageCoursesView.loadCourses(\n                    root,\n                    option.data('value'),\n                    getManageCoursesPerPage(root),\n                    $(root).find(SELECTORS.COURSES_LIST).data('currentpage')\n                );\n            }\n        );\n    };\n\n    /**\n     * Event listener for the per page selector\n     *\n     * @param {object} root The root element for the manage courses block\n     */\n    var registerManageCoursePerPageFilter = function(root) {\n        var manageCoursePerPageFilterContainer = $(root).find(SELECTORS.PER_PAGE_FILTER);\n        CustomEvents.define(manageCoursePerPageFilterContainer, [CustomEvents.events.activate]);\n        manageCoursePerPageFilterContainer.on(\n            CustomEvents.events.activate,\n            SELECTORS.FILTER_OPTION,\n            function(e, data) {\n                data.originalEvent.preventDefault();\n\n                var option = $(e.target).closest(SELECTORS.FILTER_OPTION);\n\n                if (option.hasClass('active')) {\n                    // If it's already active then we don't need to do anything.\n                    return;\n                }\n\n                $(e.target).trigger(RemuiblckEvents.MANAGE_COURSES_PAGE_FILTER_CHANGE);\n                M.util.set_user_preference('managecourseperpage', option.data('value'));\n                $(root).find(SELECTORS.COURSES_LIST).data('currentpage', 1);\n                ManageCoursesView.loadCourses(\n                    root,\n                    getManageCourseDisplay(root),\n                    option.data('value'),\n                    1\n                );\n            }\n        );\n    };\n\n    /**\n     * Event listener for the pagination controls\n     *\n     * @param {object} root The root element for the manage courses block\n     */\n    var registerManageCoursePageFilter = function(root) {\n        var manageCoursePageFilterContainer = $(root).find(SELECTORS.PAGINATE);\n        manageCoursePageFilterContainer.on(\n            'click',\n            function(e) {\n                var pagenumber = $(root).find(SELECTORS.COURSES_LIST).data('currentpage');\n                var maxpage = $(root).find(SELECTORS.COURSES_LIST).data('totalpages');\n                if ($(this).is(SELECTORS.NEXT)) {\n                    if (pagenumber == maxpage) {\n                        return;\n                    }\n                    pagenumber++;\n                } else if($(this).is(SELECTORS.PREVIOUS)) {\n                    if (pagenumber == 1) {\n                        return;\n                    }\n                    pagenumber--;\n                } else {\n                    return;\n                }\n                $(root).find(SELECTORS.COURSES_LIST).data('currentpage', pagenumber);\n                $(e.target).trigger(RemuiblckEvents.MANAGE_COURSES_PAGINATE);\n                ManageCoursesView.loadCourses(\n                    root,\n                    getManageCourseDisplay(root),\n                    getManageCoursesPerPage(root),\n                    pagenumber\n                );\n            }\n        );\n    };\n\n    /**\n     * Get manage courses display dropdown selection\n     * @param  DOM    root block DOM object\n     * @return string      selected duration option\n     */\n    var getManageCourseDisplay = function(root) {\n        return $(root).find(SELECTORS.DISPLAY_FILTER).find(SELECTORS.FILTER_OPTION + '.active').data('value');\n    }\n\n    /**\n     * Get manage courses filter dropdown selection\n     * @param  DOM    root block DOM object\n     * @return string      selected per page courses\n     */\n    var getManageCoursesPerPage = function(root) {\n        return $(root).find(SELECTORS.PER_PAGE_FILTER).find(SELECTORS.FILTER_OPTION + '.active').data('value');\n    }\n\n    /**\n     * Initialise manage courses filters events\n     * @param DOM root block DOM object\n     */\n    var init = function(root) {\n        registerManageCourseDisplayFilter(root);\n        registerManageCoursePerPageFilter(root);\n        registerManageCoursePageFilter(root);\n        ManageCoursesView.loadCourses(root, getManageCourseDisplay(root), getManageCoursesPerPage(root));\n    };\n    return {\n        init: init,\n        getManageCourseDisplay: getManageCourseDisplay\n    };\n});\n"],"file":"manage_courses_filters.min.js"}