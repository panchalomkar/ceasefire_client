{"version":3,"sources":["userstats.js"],"names":["define","$","Ajax","myDoughnut","pieOptions","segmentShowStroke","segmentStrokeColor","segmentStrokeWidth","percentageInnerCutout","animationSteps","animateRotate","animateScale","responsive","maintainAspectRatio","legendTemplate","legendtemplatestr1","tooltipTemplate","legend","display","createpiechart","category_id","data","call","methodname","args","categoryid","done","response","hide","show","empty","colors","each","labels","index","value","append","destroy","pieChartCanvas","get","getContext","doughnutData","datasets","backgroundColor","background_color","hoverBackgroundColor","hoverBackground_color","Chart","type","options","render_pie_chart","fail","ex","length","on"],"mappings":"AAAAA,OAAO,CAAC,SAAU,YAAa,gBAAiB,SAASC,EAAGC,GAKxD,IAAIC,EAAa,KAIbC,EAAa,CAEbC,mBAAmB,EAEnBC,mBAAoB,OAEpBC,mBAAoB,EAEpBC,sBAAuB,GAEvBC,eAAgB,IAOhBC,eAAe,EAEfC,cAAc,EAEdC,YAAY,EAGZC,qBAAqB,EAErBC,eAAgBC,8NAEhBC,gBAAiB,+BAEjBC,OAAQ,CACJC,SAAS,IAyBjB,SAASC,IACL,IAAIC,EAAcnB,EAAE,4CAA4CoB,KAAK,MACrEnB,EAAKoB,KAAK,CAAC,CACPC,WAAY,iDACZC,KAAM,CACFC,WAAYL,MAEhB,GAAGM,KAAK,SAASC,GACjB,GAAiB,OAAbA,EACA1B,EAAE,wBAAwB2B,OAC1B3B,EAAE,8BAA8B2B,OAChC3B,EAAE,iBAAiB2B,OACnB3B,EAAE,uBAAuB4B,WACtB,CACH5B,EAAE,uBAAuB2B,OACzB3B,EAAE,8BAA8B2B,OAChC3B,EAAE,iBAAiB4B,OACnB5B,EAAE,wBAAwB4B,OAE1B5B,EAAE,6CAA6C6B,QAC/C,IAAIC,EAAS,CAAC,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,WAC5H9B,EAAE+B,KAAKL,EAASM,OAAQ,SAAUC,EAAOC,GACrClC,EAAE,6CAA6CmC,OAAO,wCAA0CD,EAAQ,6DAA+DJ,EAAOG,GAAS,MAAQP,EAASN,KAAKa,GAAS,kBA3CtO,SAA0BP,GAEH,OAAfxB,GACAA,EAAWkC,UAGf,IAAIC,EAAiBrC,EAAE,kBAAkBsC,IAAI,GAAGC,WAAW,MAEvDC,EAAe,CACfR,OAAQN,EAASM,OACjBS,SAAU,CAAC,CACPrB,KAAMM,EAASN,KACfsB,gBAAiBhB,EAASiB,iBAC1BC,qBAAsBlB,EAASmB,yBAIvC3C,EAAa,IAAI4C,MAAMT,EAAgB,CAAEU,KAAM,WAAY3B,KAAMoB,EAAcQ,QAAS7C,IA6BhF8C,CAAiBvB,MAGtBwB,KAAK,SAASC,GACbnD,EAAE,wBAAwB2B,OAC1B3B,EAAE,uBAAuB4B,SAK7B5B,EAAE,sCAAsCoD,SACxCpD,EAAE,8DAA8DqD,GAAG,SAAU,WACzEnC,MAEJA","sourcesContent":["define(['jquery', 'core/ajax', 'core/chartjs'], function($, Ajax){\n    //----------------------------------\n    //- BEGIN PIE CHART - DOUGHNUT\n    //----------------------------------\n\n    var myDoughnut = null;\n    var legendtemplatestr1 = \"<ul class=\\\"<%=name.toLowerCase()%>-legend\\\"><% for (var i=0; i<segments.length; i++){%>\";\n    var legendtemplatestr2 = \"<span style=\\\"background-color:<%=segments[i].fillColor%>\\\"></span>\";\n    var legendtemplatestr3 = \"<%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>\";\n    var pieOptions = {\n        //Boolean - Whether we should show a stroke on each segment\n        segmentShowStroke: true,\n        //String - The colour of each segment stroke\n        segmentStrokeColor: \"#fff\",\n        //Number - The width of each segment stroke\n        segmentStrokeWidth: 1,\n        //Number - The percentage of the chart that we cut out of the middle\n        percentageInnerCutout: 50, // This is 0 for Pie charts\n        //Number - Amount of animation steps\n        animationSteps: 100,\n        //String - Animation easing effect\n        /*animation: {\n            duration: 2000,\n            easing: \"easeOutBounce\"\n        },*/\n        //Boolean - Whether we animate the rotation of the Doughnut\n        animateRotate: true,\n        //Boolean - Whether we animate scaling the Doughnut from the centre\n        animateScale: false,\n        //Boolean - whether to make the chart responsive to window resizing\n        responsive: true,\n        // Boolean - whether to maintain the starting aspect ratio or not when responsive,\n        // if set to false, will take up entire container\n        maintainAspectRatio: true,\n        //String - A legend template\n        legendTemplate: legendtemplatestr1 + legendtemplatestr2 + legendtemplatestr3,\n        //String - A tooltip template\n        tooltipTemplate: \"<%=value %> <%=label%> users\",\n\n        legend: {\n            display: false,\n        }\n    };\n\n    function render_pie_chart(response) {\n\n        if (myDoughnut !== null) {\n            myDoughnut.destroy();\n        }\n\n        var pieChartCanvas = $(\"#pieChartblock\").get(0).getContext(\"2d\");\n\n        var doughnutData = {\n            labels: response.labels,\n            datasets: [{\n                data: response.data,\n                backgroundColor: response.background_color,\n                hoverBackgroundColor: response.hoverBackground_color,\n            }]\n        };\n\n        myDoughnut = new Chart(pieChartCanvas, { type: 'doughnut', data: doughnutData, options: pieOptions });\n    }\n\n\n    function createpiechart() {\n        var category_id = $('#coursecategorylistblock option:selected').data('id');\n        Ajax.call([{\n            methodname: 'block_remuiblck_get_enrolled_users_by_category',\n            args: {\n                categoryid: category_id\n            }\n        }])[0].done(function(response) {\n            if (response === null) {\n                $('canvas#pieChartblock').hide();\n                $('.enroll-stats-nouserserror').hide();\n                $('.chart-legend').hide();\n                $('.enroll-stats-error').show();\n            } else {\n                $('.enroll-stats-error').hide();\n                $('.enroll-stats-nouserserror').hide();\n                $('.chart-legend').show();\n                $('canvas#pieChartblock').show();\n\n                $('#enrolled_users_stats_block .chart-legend').empty();\n                var colors = ['#2196f3', '#00bcd4', '#009688', '#4caf50', '#8bc34a', '#ffeb3b', '#ff9800', '#f44336', '#9c27b0', '#673ab7', '#3f51b5'];\n                $.each(response.labels, function (index, value) {\n                    $('#enrolled_users_stats_block .chart-legend').append('<li class=\"list-group-item p-0 pt-1\">' + value + ': <span class=\"badge badge-round\" style=\"background-color:' + colors[index] + ';\">' + response.data[index] + '</span></li>');\n                });\n\n                render_pie_chart(response);\n            }\n\n        }).fail(function(ex) {\n            $('canvas#pieChartblock').hide();\n            $('.enroll-stats-error').show();\n        });\n    }\n\n    // update pie chart on category selection\n    if ($('#enrolled_users_stats_block select').length) {\n        $('#enrolled_users_stats_block select#coursecategorylistblock').on('change', function () {\n            createpiechart();\n        });\n        createpiechart();\n    }\n    //----------------------------------\n    //- END PIE CHART - DOUGHNUT\n    //----------------------------------\n\n});\n"],"file":"userstats.min.js"}