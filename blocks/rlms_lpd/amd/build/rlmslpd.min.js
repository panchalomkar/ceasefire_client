define(["jquery","jqueryui"],(function(t){function a(){t(".lpd-lp-detail-body canvas").each((function(){switch(t(this).data("element")){case"first":(e=this.getContext("2d")).beginPath(),e.moveTo(15,15),e.lineTo(15,30),e.lineWidth=2,e.strokeStyle=t(this).parent().children("i").data("color"),e.stroke();break;case"middle":(e=this.getContext("2d")).beginPath(),e.moveTo(15,0),e.lineTo(15,30),e.lineWidth=2,e.strokeStyle=t(this).parent().children("i").data("color"),e.stroke();break;case"last":var e;(e=this.getContext("2d")).beginPath(),e.moveTo(15,0),e.lineTo(15,15),e.lineWidth=2,e.strokeStyle=t(this).parent().children("i").data("color"),e.stroke()}t(".block_rlms_lpd_content .tooltipelement_html").tooltip({html:!0,placement:"right"})}))}return{init:function(){t(document).ready((function(){paginationAjax(),t.ajaxPrefilter((function(t,e,a){t.async=!0})),t("#block_rlms_lpd_content .lpd-lp-content-header").click((function(){var e=t(this).attr("data-lpid"),l=get("page"),i=get("lp_id"),n=t(this);t(this).hasClass("collapsedlpd")?(t("#block_rlms_lpd_content .lpd-lp-content-header").addClass("collapsedlpd"),t.ajax({type:"POST",dataType:"json",data:{action:"getLpDetail",learningPath:e,page:l,lpid_selected:i},url:M.cfg.wwwroot+"/blocks/rlms_lpd/lib/ajax.php",async:!1}).done((function(t){t.view&&""!==t.view&&(n.parent().find(".lpd-lp-detail").html(t.view),n.parent().css("height","auto"),a()),paginationAjax()}))):t(this).parent().find(".lpd-lp-detail").empty(),t(this).hasClass("collapsedlpd")?t(this).removeClass("collapsedlpd"):t(this).addClass("collapsedlpd")}));var l=parseInt(get("lp_id"));jQuery("#block_rlms_lpd_content .lpd-lp-content").each((function(t,a){e=jQuery(a).find(".lpd-lp-content-header"),lpid=e.attr("data-lpid"),lpid>0&&l==lpid&&jQuery(e).click()})),t("#block_rlms_lpd_content div.lpd-lp-content-header").click((function(){t("#block_rlms_lpd_content div.lpd-lp-content-header").each((function(){t(this).hasClass("collapsedlpd")&&(t(this).parent().removeClass("card-box"),t(this).parent().find(".lpd-lp-detail").empty())})),t(this).hasClass("collapsedlpd")&&t(this).parent().removeClass("card-box"),t(this).hasClass("collapsedlpd")||t(this).parent().addClass("card-box")})),t("div.tbs-content ul li#view-button").click((function(){a()})),t(document).on("click",".pagination_lpdd ul.pagination li > a",(function(e){e.preventDefault();var a=(l=t(this).attr("href")).split("&");a=a[2].split("=");t("#useridloged").val();var l=M.cfg.wwwroot+"/blocks/rlms_lpd/ajax.php";return t.ajax({type:"GET",url:l,data:{page:a[1]},dataType:"text",success:function(e){t("div.block_rlms_lpd_content").html(e)}}),!1}))}))}}}));